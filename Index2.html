<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Rock paper scissor 2.0</title>
    <link rel="stylesheet" type="text/css" href="Index2-css.css"/>
  </head>
  <body>
    <h2>Rock, Paper, Scissors</h2>
    <p>Pick your choice and the game of 5 rounds will start.</p>
    <div id="btns">
        <button value="Rock">Rock</button>
        <button value="Paper">Paper</button>
        <button value="Scissors">Scissors</button>
    </div>
    <div id="result"></div>
    <script>
      let pScore = 0, cScore = 0, roundCount = 0;
      
      function compPlay(){
        let possibleMove = ["Rock", "Paper", "Scissors"];
        let move = possibleMove[Math.floor(Math.random()*3)];
        return move;
      }

      function gameLogic(player, comp = compPlay()){
        let result;
        if((comp === "Rock" && player === "Scissors") || (comp === "Paper" && player === "Rock") || (comp === "Scissors" && player === "Paper")){
          result = "It seems like you lost the round, computer chose " + comp + ", and " + comp + " beats " + player + "!" + "\n";
          cScore++;
          return result;
        }
        else if((player === "Rock" && comp === "Scissors") || (player === "Paper" && comp === "Rock") || (player === "Scissors" && comp === "Paper")){
          result = "It seems like you won the round, computer chose " + comp + ", and " + player + " beats " + comp + "!" + "\n";
          pScore++;
          return result;
        }
        else if(comp === player){
          result = "It's a tie, computer also chose " + comp + "\n";
          cScore++;
          pScore++;
          return result;
        }
      }

      function gameRound(e){
        let pChoice = e.target.getAttribute("value");
        let msg = gameLogic(pChoice);
        let resultDiv = document.querySelector("#result");
        let resultP = document.createElement("p");
        msg += "Player's Score - " + pScore + " | Computer's Score - " + cScore + "\n";
        if(roundCount === 5){
          if(pScore > cScore){
            msg += "Congratulations! You won the game!";
          }
          else if(cScore > pScore){
            msg += "You lost but don't be sad, you can play again.";
          }
          else{
            msg += "It's a tie!";
          }
        }
        resultP.innerText = msg;
        resultDiv.appendChild(resultP);
      }
      
      const pBtnChoice = document.querySelectorAll("#btns > button");
      pBtnChoice.forEach(btn => btn.addEventListener("click", (e) => {
        if(roundCount >= 5){
          const resultPs = document.querySelectorAll("#result > p");
          const resultDiv = document.querySelector("#result");
          resultPs.forEach(p => resultDiv.removeChild(p));
          roundCount = 0;
          pScore = 0;
          cScore = 0;
        }
        roundCount++;
        gameRound(e);
      }));
    </script>
  </body>
</html>
